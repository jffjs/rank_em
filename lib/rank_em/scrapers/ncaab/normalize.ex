defmodule RankEm.Scrapers.NCAAB.Normalize do
  @moduledoc """
  Normalize team and conference names to those used by KenPom.
  """

  @conference_map %{
    "big10" => "B10",
    "bigten" => "B10",
    "big12" => "B12",
    "bigtwelve" => "B12",
    "mountainwest" => "MWC",
    "pac-12" => "P12",
    "pac12" => "P12",
    "pactwelve" => "P12",
    "pacific12" => "P12",
    "bigeast" => "BE",
    "aac" => "Amer",
    "americanathletic" => "Amer",
    "socon" => "SC",
    "southern" => "SC",
    "atlantic10" => "A10",
    "atlanticten" => "A10",
    "atlanticsun" => "ASun",
    "asun" => "ASun",
    "ivyleague" => "Ivy",
    "ivy" => "Ivy",
    "southland" => "Slnd",
    "c-usa" => "CUSA",
    "bigwest" => "BW",
    "bigsky" => "BSky",
    "sunbelt" => "SB",
    "patriot" => "Pat",
    "patriotleague" => "Pat",
    "pat" => "Pat",
    "horizon" => "Horz",
    "summit" => "Sum",
    "summitleague" => "Sum",
    "summitlg" => "Sum",
    "bigsouth" => "BSth",
    "americaeast" => "AE",
    "westcoast" => "WCC",
    "southeastern" => "SEC",
    "atlanticcoast" => "ACC",
    "missourival" => "MVC",
    "missourivalley" => "MVC",
    "mid-american" => "MAC",
    "westernathletic" => "WAC",
    "conferenceusa" => "CUSA",
    "ohvalley" => "OVC",
    "ohiovalley" => "OVC",
    "colonial" => "CAA",
    "metroatlantic" => "MAAC",
    "northeast" => "NEC",
    "southwesternac" => "SWAC",
    "mid-easternac" => "MEAC"
  }
  def conference(conf) do
    normalized = conf |> String.replace(~r/\s/, "") |> String.downcase()
    Map.get(@conference_map, normalized, conf)
  end

  @team_map %{
    "ETSU" => "East Tennessee St.",
    "Saint Mary's (CA)" => "Saint Mary's",
    "St Mary's CA" => "Saint Mary's",
    "Mt St Mary's" => "Mount St. Mary's",
    "SFA" => "Stephen F. Austin",
    "SF Austin" => "Stephen F. Austin",
    "Northern Colo." => "Northern Colorado",
    "N Colorado" => "Northern Colorado",
    "Saint Francis (PA)" => "St. Francis PA",
    "St Francis PA" => "St. Francis PA",
    "Prairie View" => "Prairie View A&M",
    "LMU (CA)" => "Loyola Marymount",
    "Loy Marymount" => "Loyola Marymount",
    "N.C. Central" => "North Carolina Central",
    "NC Central" => "North Carolina Central",
    "Mississippi Val." => "Mississippi Valley St.",
    "MS Valley St." => "Mississippi Valley St.",
    "Central Conn. St." => "Central Connecticut",
    "Central Conn" => "Central Connecticut",
    "Southeastern La." => "Southeastern Louisiana",
    "North Carolina St." => "N.C. State",
    "NC St." => "N.C. State",
    "N.C. St." => "N.C. State",
    "Fort Wayne" => "Purdue Fort Wayne",
    "PFW" => "Purdue Fort Wayne",
    "LIU Brooklyn" => "LIU",
    "College of Charleston" => "Charleston",
    "Col. of Charleston" => "Charleston",
    "Col Charleston" => "Charleston",
    "Louisiana Lafayette" => "Louisiana",
    "Gardner-Webb" => "Gardner Webb",
    "UTRGV" => "UT Rio Grande Valley",
    "Kansas City" => "UMKC",
    "Missouri KC" => "UMKC",
    "Boston U." => "Boston University",
    "Boston Univ" => "Boston University",
    "FGCU" => "Florida Gulf Coast",
    "FL Gulf Coast" => "Florida Gulf Coast",
    "Loyola Maryland" => "Loyola MD",
    "Grambling" => "Grambling St.",
    "Omaha" => "Nebraska Omaha",
    "NE Omaha" => "Nebraska Omaha",
    "Lamar University" => "Lamar",
    "Eastern Ky." => "Eastern Kentucky",
    "E Kentucky" => "Eastern Kentucky",
    "UIW" => "Incarnate Word",
    "Western Ky." => "Western Kentucky",
    "W Kentucky" => "Western Kentucky",
    "WKU" => "Western Kentucky",
    "South Fla." => "South Florida",
    "UIC" => "Illinois Chicago",
    "IL Chicago" => "Illinois Chicago",
    "Charleston So." => "Charleston Southern",
    "Charleston So" => "Charleston Southern",
    "California Baptist" => "Cal Baptist",
    "A&M-Corpus Christi" => "Texas A&M Corpus Chris",
    "TAM C. Christi" => "Texas A&M Corpus Chris",
    "Middle Tenn." => "Middle Tennessee",
    "MTSU" => "Middle Tennessee",
    "Albany (NY)" => "Albany",
    "SUNY Albany" => "Albany",
    "CSU Bakersfield" => "Cal St. Bakersfield",
    "CS Bakersfield" => "Cal St. Bakersfield",
    "Ole Miss" => "Mississippi",
    "UNI" => "Northern Iowa",
    "SIUE" => "SIU Edwardsville",
    "North Ala." => "North Alabama",
    "UConn" => "Connecticut",
    "Western Mich." => "Western Michigan",
    "W Michigan" => "Western Michigan",
    "UMES" => "Maryland Eastern Shore",
    "MD E Shore" => "Maryland Eastern Shore",
    "Southeast Mo. St." => "Southeast Missouri St.",
    "SE Missouri St." => "Southeast Missouri St.",
    "Northern Ill." => "Northern Illinois",
    "N Illinois" => "Northern Illinois",
    "N.C. A&T" => "North Carolina A&T",
    "NC A&T" => "North Carolina A&T",
    "Fla. Atlantic" => "Florida Atlantic",
    "FL Atlantic" => "Florida Atlantic",
    "Northern Ariz." => "Northern Arizona",
    "Southern Ill." => "Southern Illinois",
    "S Illinois" => "Southern Illinois",
    "Army West Point" => "Army",
    "UT Martin" => "Tennessee Martin",
    "TN Martin" => "Tennessee Martin",
    "Western Caro." => "Western Carolina",
    "W Carolina" => "Western Carolina",
    "Southern California" => "USC",
    "Central Ark." => "Central Arkansas",
    "Cent Arkansas" => "Central Arkansas",
    "Western Ill." => "Western Illinois",
    "W Illinois" => "Western Illinois",
    "Southern U." => "Southern Utah",
    "McNeese" => "McNeese St.",
    "St. John's (NY)" => "St. John's",
    "St John's" => "St. John's",
    "Northern Ky." => "Northern Kentucky",
    "N Kentucky" => "Northern Kentucky",
    "UNCW" => "UNC Wilmington",
    "Southern Miss." => "Southern Miss",
    "La.-Monroe" => "Louisiana Monroe",
    "ULM" => "Louisiana Monroe",
    "Detroit Mercy" => "Detroit",
    "Miami (FL)" => "Miami FL",
    "Miami (OH)" => "Miami OH",
    "Central Mich." => "Central Michigan",
    "C Michigan" => "Central Michigan",
    "Eastern Ill." => "Eastern Illinois",
    "E Illinois" => "Eastern Illinois",
    "Ga. Southern" => "Georgia Southern",
    "Ga Southern" => "Georgia Southern",
    "St. Francis Brooklyn" => "St. Francis NY",
    "St Francis NY" => "St. Francis NY",
    "Bethune-Cookman" => "Bethune Cookman",
    "Ark.-Pine Bluff" => "Arkansas Pine Bluff",
    "Ark Pine Bluff" => "Arkansas Pine Bluff",
    "Seattle U" => "Seattle",
    "Eastern Wash." => "Eastern Washington",
    "E Washington" => "Eastern Washington",
    "Eastern Mich." => "Eastern Michigan",
    "E Michigan" => "Eastern Michigan",
    "Alcorn" => "Alcorn St.",
    "CSUN" => "Cal St. Northridge",
    "CS Northridge" => "Cal St. Northridge",
    "Michigan St" => "Michigan St.",
    "S Dakota St." => "South Dakota St.",
    "N Dakota St." => "North Dakota St.",
    "St Bonaventure" => "St. Bonaventure",
    "F Dickinson" => "Fairleigh Dickinson",
    "MA Lowell" => "UMass Lowell",
    "SC Upstate" => "USC Upstate",
    "Kent" => "Kent St.",
    "WI Green Bay" => "Green Bay",
    "Monmouth NJ" => "Monmouth",
    "Coastal Car" => "Coastal Carolina",
    "Florida Intl" => "FIU",
    "Ark Little Rock" => "Little Rock",
    "Citadel" => "The Citadel",
    "St Louis" => "Saint Louis",
    "UT San Antonio" => "UTSA",
    "G Washington" => "George Washington",
    "Kennesaw" => "Kennesaw St.",
    "Abilene Chr" => "Abilene Christian",
    "S Carolina St." => "South Carolina St.",
    "St Peter's" => "Saint Peter's",
    "St Joseph's PA" => "Saint Joseph's",
    "American Univ" => "American",
    "Houston Bap" => "Houston Baptist",
    "Loyola-Chicago" => "Loyola Chicago",
    "Southern Univ" => "Southern",
    "CS Sacramento" => "Sacramento St.",
    "CS Fullerton" => "Cal St. Fullerton",
    "SE Louisiana" => "Southeastern Louisiana",
    "Northwestern LA" => "Northwestern St.",
    "TX Southern" => "Texas Southern",
    "WI Milwaukee" => "Milwaukee"
  }

  def team(team) do
    team = String.replace(team, "State", "St.")
    team = String.replace(team, ~r/St$/, "St.")
    Map.get(@team_map, team, team)
  end
end
